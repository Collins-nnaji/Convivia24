module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},70864,a=>{a.n(a.i(33290))},43619,a=>{a.n(a.i(79962))},13718,a=>{a.n(a.i(85523))},18198,a=>{a.n(a.i(45518))},62212,a=>{a.n(a.i(66114))},67971,a=>{a.n(a.i(26435))},76869,a=>{"use strict";a.s(["ListingsFilters",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ListingsFilters() from the server but ListingsFilters is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/app/admin/listings/ListingsFilters.tsx <module evaluation>","ListingsFilters")},2828,a=>{"use strict";a.s(["ListingsFilters",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ListingsFilters() from the server but ListingsFilters is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/app/admin/listings/ListingsFilters.tsx","ListingsFilters")},80349,a=>{"use strict";a.i(76869);var b=a.i(2828);a.n(b)},41338,a=>{"use strict";var b=a.i(7997),c=a.i(53058),d=a.i(12259),e=a.i(95936),f=a.i(80349);async function g(a){let g;await (0,c.requireAdmin)();let h=await a.searchParams,i=h.client_id??null,j=h.status??null,k=await d.default`SELECT id, name FROM clients ORDER BY name`;g=i&&j?await d.default`
      SELECT l.*, c.name as client_name
      FROM listings l
      JOIN clients c ON c.id = l.client_id
      WHERE l.client_id = ${i} AND l.status = ${j}
      ORDER BY l.updated_at DESC
    `:i?await d.default`
      SELECT l.*, c.name as client_name
      FROM listings l
      JOIN clients c ON c.id = l.client_id
      WHERE l.client_id = ${i}
      ORDER BY l.updated_at DESC
    `:j?await d.default`
      SELECT l.*, c.name as client_name
      FROM listings l
      JOIN clients c ON c.id = l.client_id
      WHERE l.status = ${j}
      ORDER BY l.updated_at DESC
    `:await d.default`
      SELECT l.*, c.name as client_name
      FROM listings l
      JOIN clients c ON c.id = l.client_id
      ORDER BY l.updated_at DESC
    `;let l={draft:"Draft",submitted:"Submitted",price_agreed:"Price agreed",listed:"Listed",sold:"Sold",withdrawn:"Withdrawn"};function m(a,b){if(null==a||""===a)return"—";let c="string"==typeof a?parseFloat(a):Number(a);return isNaN(c)?"—":`${"GBP"===b?"£":b+" "}${c.toLocaleString()}`}let n=g.filter(a=>"draft"===String(a.status)).length,o=g.filter(a=>["submitted","price_agreed","listed"].includes(String(a.status))).length,p=g.filter(a=>"sold"===String(a.status)).length;return(0,b.jsxs)("div",{className:"p-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("span",{className:"inline-block bg-red-700 text-white text-[9px] font-black uppercase tracking-[0.2em] px-2 py-1 mb-3",children:"Listings"}),(0,b.jsx)("h1",{className:"text-3xl font-black tracking-tighter text-white uppercase italic",children:"Items to sell"}),(0,b.jsx)("p",{className:"text-zinc-500 text-sm mt-1",children:"Partner listings: agree price and commission in Messages, then set agreed terms and mark sold here."})]}),(0,b.jsx)(f.ListingsFilters,{clients:k,currentClientId:i,currentStatus:j}),g.length>0&&(0,b.jsxs)("div",{className:"flex flex-wrap gap-4 mt-4 mb-3 text-sm",children:[(0,b.jsxs)("span",{className:"text-zinc-400",children:[(0,b.jsx)("strong",{className:"text-zinc-200",children:g.length})," showing"]}),n>0&&(0,b.jsxs)("span",{className:"text-zinc-500",children:[n," draft"]}),o>0&&(0,b.jsxs)("span",{className:"text-zinc-500",children:[o," in progress"]}),p>0&&(0,b.jsxs)("span",{className:"text-zinc-500",children:[p," sold"]})]}),(0,b.jsx)("div",{className:"bg-zinc-900 border border-zinc-800 mt-2",children:0===g.length?(0,b.jsx)("p",{className:"text-zinc-600 text-sm text-center py-12",children:"No listings match the filters."}):(0,b.jsx)("div",{className:"divide-y divide-zinc-800",children:g.map(a=>{let c,d;return(0,b.jsxs)(e.default,{href:`/admin/listings/${a.id}`,className:"flex flex-wrap items-center justify-between gap-4 px-6 py-4 hover:bg-zinc-800 transition-colors",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mb-0.5",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-white truncate",children:String(a.title)}),(0,b.jsx)("span",{className:"text-[10px] text-zinc-500 shrink-0",children:(c=new Date(String(a.updated_at)),0===(d=Math.floor((new Date().getTime()-c.getTime())/864e5))?"Today":1===d?"Yesterday":d<7?`${d} days ago`:d<30?`${Math.floor(d/7)} weeks ago`:c.toLocaleDateString("en-GB"))})]}),(0,b.jsx)("p",{className:"text-[11px] text-zinc-500 truncate",children:String(a.client_name)}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-3 mt-1 text-[11px] text-zinc-400",children:[(0,b.jsxs)("span",{children:["Asking: ",m(a.asking_price,String(a.currency??"GBP"))]}),null!=a.agreed_price&&""!==a.agreed_price&&(0,b.jsxs)("span",{children:["Agreed: ",m(a.agreed_price,String(a.currency??"GBP"))]}),null!=a.agreed_commission_pct&&""!==a.agreed_commission_pct&&(0,b.jsxs)("span",{children:["Commission: ",Number(a.agreed_commission_pct),"%"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-[10px] font-black uppercase px-2 py-0.5 rounded bg-zinc-700 text-zinc-300",children:l[String(a.status)]??String(a.status)}),(0,b.jsx)("span",{className:"text-zinc-600",children:"→"})]})]},String(a.id))})})})]})}a.s(["default",()=>g])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__b45b874b._.js.map