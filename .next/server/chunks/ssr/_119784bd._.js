module.exports=[70106,a=>{"use strict";var b=a.i(72131);let c=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let e=(0,b.forwardRef)(({color:a="currentColor",size:e=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...d,width:e,height:e,stroke:a,strokeWidth:g?24*Number(f)/Number(e):f,className:c("lucide",h),...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),f=(a,d)=>{let f=(0,b.forwardRef)(({className:f,...g},h)=>(0,b.createElement)(e,{ref:h,iconNode:d,className:c(`lucide-${a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,f),...g}));return f.displayName=`${a}`,f};a.s(["default",()=>f],70106)},92759,a=>{"use strict";let b=(0,a.i(70106).default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);a.s(["Send",()=>b],92759)},33441,a=>{"use strict";let b=(0,a.i(70106).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);a.s(["Check",()=>b],33441)},210,a=>{"use strict";let b=(0,a.i(70106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},33508,a=>{"use strict";let b=(0,a.i(70106).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);a.s(["X",()=>b],33508)},43558,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(210),g=a.i(92759),h=a.i(70106);let i=(0,h.default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),j=(0,h.default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var k=a.i(33441),l=a.i(33508);let m={draft:"Draft",submitted:"Submitted",price_agreed:"Price agreed",listed:"Listed",sold:"Sold",withdrawn:"Withdrawn"},n={draft:"Edit and submit when ready. We’ll then agree price and commission in Messages.",submitted:"We’re reviewing. We’ll message you to agree price and commission.",price_agreed:"Terms are agreed. We’re listing and working on the sale.",listed:"Listed for sale. We’ll update you when it sells.",sold:"Sold. Sale value and commission are recorded.",withdrawn:"This listing was withdrawn."};function o(a,b){if(null==a||""===a)return"—";let c="string"==typeof a?parseFloat(a):a;return isNaN(c)?"—":`${"GBP"===b?"£":b+" "}${c.toLocaleString()}`}function p(){let a,h;(0,d.useRouter)();let p=(0,d.useParams)(),q=p?.id,[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)("GBP"),[H,I]=(0,c.useState)("");async function J(){if(r){w(!0);try{let a=await fetch(`/api/listings/${r.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({action:"submit"})});if(a.ok){let b=await a.json();s(b)}}finally{w(!1)}}}async function K(){if(!r)return;let a=await fetch(`/api/listings/${r.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:z.trim(),description:B.trim()||void 0,asking_price:D?Number(D):void 0,currency:F,commission_pct:H?Number(H):void 0})});a.ok&&(s(await a.json()),y(!1))}if((0,c.useEffect)(()=>{q&&fetch(`/api/listings/${q}`,{credentials:"include"}).then(a=>a.ok?a.json():null).then(a=>{a&&(s(a),A(a.title??""),C(a.description??""),E(null!=a.asking_price&&""!==a.asking_price?String(a.asking_price):""),G(a.currency??"GBP"),I(null!=a.commission_pct&&""!==a.commission_pct?String(a.commission_pct):""))}).finally(()=>u(!1))},[q]),t||!r)return(0,b.jsxs)("div",{className:"p-8",children:[(0,b.jsx)("p",{className:"text-zinc-500 text-sm",children:t?"Loading…":"Listing not found."}),!t&&(0,b.jsx)(e.default,{href:"/dashboard/listings",className:"text-red-600 text-sm font-semibold mt-2 inline-block",children:"← Back to listings"})]});let L="draft"===r.status;return(0,b.jsxs)("div",{className:"p-8 max-w-2xl",children:[(0,b.jsxs)(e.default,{href:"/dashboard/listings",className:"inline-flex items-center gap-1.5 text-zinc-600 hover:text-zinc-900 text-sm font-semibold mb-6",children:[(0,b.jsx)(f.ArrowLeft,{size:14}),"Back to listings"]}),(0,b.jsxs)("div",{className:"bg-white border border-zinc-200 rounded-lg shadow-sm overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-6 py-4 border-b border-zinc-200 flex items-center justify-between flex-wrap gap-2",children:[(0,b.jsx)("span",{className:"text-[10px] font-black uppercase px-2 py-0.5 rounded bg-zinc-200 text-zinc-700",children:m[r.status]??r.status}),L&&!x&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>y(!0),className:"inline-flex items-center gap-1.5 text-zinc-600 hover:text-zinc-900 text-xs font-semibold",children:[(0,b.jsx)(j,{size:12}),"Edit"]}),(0,b.jsxs)("button",{type:"button",onClick:J,disabled:v,className:"inline-flex items-center gap-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold uppercase px-3 py-2 rounded transition-colors disabled:opacity-60",children:[(0,b.jsx)(g.Send,{size:12}),v?"Submitting…":"Submit to Convivia24"]})]})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[n[r.status]&&(0,b.jsx)("p",{className:"text-sm text-zinc-600 bg-zinc-50 border border-zinc-200 rounded-lg px-4 py-3",children:n[r.status]}),x?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold uppercase text-zinc-500 mb-1",children:"Title *"}),(0,b.jsx)("input",{value:z,onChange:a=>A(a.target.value),className:"w-full border border-zinc-200 rounded px-3 py-2 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold uppercase text-zinc-500 mb-1",children:"Description"}),(0,b.jsx)("textarea",{value:B,onChange:a=>C(a.target.value),rows:3,className:"w-full border border-zinc-200 rounded px-3 py-2 text-sm resize-y"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold uppercase text-zinc-500 mb-1",children:"Asking price"}),(0,b.jsx)("input",{type:"number",min:"0",step:"0.01",value:D,onChange:a=>E(a.target.value),className:"w-full border border-zinc-200 rounded px-3 py-2 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold uppercase text-zinc-500 mb-1",children:"Currency"}),(0,b.jsxs)("select",{value:F,onChange:a=>G(a.target.value),className:"w-full border border-zinc-200 rounded px-3 py-2 text-sm",children:[(0,b.jsx)("option",{value:"GBP",children:"GBP"}),(0,b.jsx)("option",{value:"USD",children:"USD"}),(0,b.jsx)("option",{value:"EUR",children:"EUR"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold uppercase text-zinc-500 mb-1",children:"Commission %"}),(0,b.jsx)("input",{type:"number",min:"0",max:"100",step:"0.5",value:H,onChange:a=>I(a.target.value),className:"w-full border border-zinc-200 rounded px-3 py-2 text-sm max-w-[120px]"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("button",{type:"button",onClick:K,className:"inline-flex items-center gap-1.5 bg-red-600 hover:bg-red-700 text-white text-sm font-bold px-4 py-2 rounded",children:[(0,b.jsx)(k.Check,{size:14}),"Save"]}),(0,b.jsxs)("button",{type:"button",onClick:()=>y(!1),className:"inline-flex items-center gap-1.5 border border-zinc-300 text-zinc-700 text-sm font-semibold px-4 py-2 rounded hover:bg-zinc-50",children:[(0,b.jsx)(l.X,{size:14}),"Cancel"]})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-xl font-black text-zinc-900 tracking-tight",children:r.title}),(0,b.jsxs)("p",{className:"text-[11px] text-zinc-500 mt-1",children:["Updated ",(a=new Date(r.updated_at),0===(h=Math.floor((new Date().getTime()-a.getTime())/864e5))?"Today":1===h?"Yesterday":h<7?`${h} days ago`:h<30?`${Math.floor(h/7)} weeks ago`:a.toLocaleDateString())]})]}),r.description&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xs font-bold uppercase text-zinc-500 mb-1",children:"Description"}),(0,b.jsx)("p",{className:"text-sm text-zinc-700 whitespace-pre-wrap",children:r.description})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] text-zinc-500 uppercase font-bold",children:"Asking price"}),(0,b.jsx)("p",{className:"text-zinc-900",children:o(r.asking_price,r.currency)})]}),null!=r.agreed_price&&""!==r.agreed_price&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] text-zinc-500 uppercase font-bold",children:"Agreed price"}),(0,b.jsx)("p",{className:"text-zinc-900",children:o(r.agreed_price,r.currency)})]}),null!=r.commission_pct&&""!==r.commission_pct||null!=r.agreed_commission_pct&&""!==r.agreed_commission_pct?(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] text-zinc-500 uppercase font-bold",children:"Commission"}),(0,b.jsxs)("p",{className:"text-zinc-900",children:[Number(r.agreed_commission_pct??r.commission_pct),"%"]})]}):null,"sold"===r.status&&null!=r.sale_value&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] text-zinc-500 uppercase font-bold",children:"Sale value"}),(0,b.jsx)("p",{className:"text-green-700 font-semibold",children:o(r.sale_value,r.currency)})]})]})]}),(0,b.jsxs)(e.default,{href:"/dashboard/messages",className:"inline-flex items-center gap-2 text-red-600 hover:text-red-700 text-sm font-semibold",children:[(0,b.jsx)(i,{size:14}),"Open Messages to discuss this listing"]})]})]})]})}a.s(["default",()=>p],43558)}];

//# sourceMappingURL=_119784bd._.js.map