{"version":3,"sources":["../../../../node_modules/lucide-react/src/icons/arrow-right.ts","../../../../app/admin/page.tsx"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M5 12h14', key: '1ays0h' }],\n  ['path', { d: 'm12 5 7 7-7 7', key: 'xquz4c' }],\n];\n\n/**\n * @component @name ArrowRight\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNSAxMmgxNCIgLz4KICA8cGF0aCBkPSJtMTIgNSA3IDctNyA3IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/arrow-right\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowRight = createLucideIcon('ArrowRight', __iconNode);\n\nexport default ArrowRight;\n","import { requireAdmin } from '@/lib/auth/session';\nimport sql from '@/lib/db';\nimport Link from 'next/link';\nimport { Users, GitBranch, MessageSquare, ClipboardList, ArrowRight } from 'lucide-react';\n\nexport default async function AdminOverview() {\n  await requireAdmin();\n\n  const [\n    clientCount,\n    dealCount,\n    unreadCount,\n    leadCount,\n    recentDeals,\n    recentLeads,\n  ] = await Promise.all([\n    sql`SELECT COUNT(*) as count FROM clients WHERE status = 'active'`,\n    sql`SELECT COUNT(*) as count FROM pipeline_deals WHERE stage NOT IN ('closed_won','closed_lost')`,\n    sql`SELECT COUNT(*) as count FROM messages WHERE sender_role = 'client' AND read_at IS NULL`,\n    sql`SELECT COUNT(*) as count FROM audit_leads WHERE status = 'new'`,\n    sql`SELECT d.*, c.name as client_name FROM pipeline_deals d JOIN clients c ON c.id = d.client_id ORDER BY d.updated_at DESC LIMIT 6`,\n    sql`SELECT * FROM audit_leads WHERE status = 'new' ORDER BY created_at DESC LIMIT 5`,\n  ]);\n\n  const stats = [\n    { label: 'Active Clients',    value: Number(clientCount[0]?.count ?? 0),  icon: Users,         href: '/admin/clients' },\n    { label: 'Open Deals',        value: Number(dealCount[0]?.count ?? 0),    icon: GitBranch,     href: '/admin/pipeline' },\n    { label: 'Unread Messages',   value: Number(unreadCount[0]?.count ?? 0),  icon: MessageSquare, href: '/admin/messages' },\n    { label: 'New Audit Leads',   value: Number(leadCount[0]?.count ?? 0),    icon: ClipboardList, href: '/admin/leads' },\n  ];\n\n  const STAGE_COLORS: Record<string, string> = {\n    lead: 'bg-zinc-700', qualified: 'bg-blue-700', proposal: 'bg-yellow-600',\n    negotiation: 'bg-orange-600', closed_won: 'bg-green-700', closed_lost: 'bg-zinc-600',\n  };\n\n  return (\n    <div className=\"p-8 max-w-6xl\">\n      <div className=\"mb-8\">\n        <span className=\"inline-block bg-red-700 text-white text-[9px] font-black uppercase tracking-[0.2em] px-2 py-1 mb-3\">\n          Command Center\n        </span>\n        <h1 className=\"text-3xl font-black tracking-tighter text-white uppercase italic\">\n          Admin Overview\n        </h1>\n        <p className=\"text-zinc-500 text-sm mt-1\">Everything across all client accounts</p>\n      </div>\n\n      {/* Stats */}\n      <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\n        {stats.map(({ label, value, icon: Icon, href }) => (\n          <Link key={label} href={href}\n            className=\"group bg-zinc-900 border border-zinc-800 hover:border-red-700 p-5 transition-colors\"\n          >\n            <Icon size={16} className=\"text-red-700 mb-3\" />\n            <p className=\"text-2xl font-black text-white tracking-tighter\">{value}</p>\n            <p className=\"text-[11px] text-zinc-500 uppercase tracking-[0.15em] mt-1\">{label}</p>\n          </Link>\n        ))}\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Recent deals */}\n        <div className=\"bg-zinc-900 border border-zinc-800\">\n          <div className=\"flex items-center justify-between px-6 py-4 border-b border-zinc-800\">\n            <h2 className=\"text-sm font-black uppercase tracking-[0.15em] text-white\">Recent Deals</h2>\n            <Link href=\"/admin/pipeline\" className=\"text-[11px] text-red-500 hover:text-red-400 flex items-center gap-1\">\n              All <ArrowRight size={11} />\n            </Link>\n          </div>\n          <div className=\"divide-y divide-zinc-800\">\n            {recentDeals.map((d: any) => (\n              <div key={d.id} className=\"flex items-center justify-between px-6 py-3\">\n                <div className=\"flex items-center gap-2 min-w-0\">\n                  <span className={`shrink-0 text-[9px] font-black uppercase text-white px-1.5 py-0.5 ${STAGE_COLORS[d.stage] || 'bg-zinc-700'}`}>\n                    {d.stage.replace('_', ' ')}\n                  </span>\n                  <div className=\"min-w-0\">\n                    <p className=\"text-sm text-zinc-200 truncate\">{d.title}</p>\n                    <p className=\"text-[11px] text-zinc-500 truncate\">{d.client_name}</p>\n                  </div>\n                </div>\n                {d.value && (\n                  <span className=\"text-sm font-semibold text-white shrink-0 ml-2\">\n                    Â£{parseFloat(d.value).toLocaleString()}\n                  </span>\n                )}\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* New leads */}\n        <div className=\"bg-zinc-900 border border-zinc-800\">\n          <div className=\"flex items-center justify-between px-6 py-4 border-b border-zinc-800\">\n            <h2 className=\"text-sm font-black uppercase tracking-[0.15em] text-white\">New Audit Leads</h2>\n            <Link href=\"/admin/leads\" className=\"text-[11px] text-red-500 hover:text-red-400 flex items-center gap-1\">\n              All <ArrowRight size={11} />\n            </Link>\n          </div>\n          <div className=\"divide-y divide-zinc-800\">\n            {recentLeads.length === 0 && (\n              <p className=\"text-zinc-600 text-sm text-center py-6\">No new leads</p>\n            )}\n            {recentLeads.map((lead: any) => (\n              <div key={lead.id} className=\"px-6 py-3\">\n                <p className=\"text-sm font-semibold text-white\">{lead.company || 'Unknown Company'}</p>\n                <p className=\"text-[11px] text-zinc-500\">{lead.email}</p>\n                <p className=\"text-[10px] text-zinc-600 mt-0.5\">\n                  {new Date(lead.created_at).toLocaleDateString('en-GB')}\n                </p>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}