{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/collinsnnaji/VSCodeDevelopments/convivia24/app/api/chat/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { neon } from '@neondatabase/serverless';\n\ntype RequestBody = {\n  name?: string;\n  email?: string;\n  subject?: string;\n  message?: string;\n};\n\nexport async function POST(req: NextRequest) {\n  try {\n    const { name, email, subject, message } = (await req.json()) as RequestBody;\n    const trimmedMessage = message?.trim() ?? '';\n\n    if (!trimmedMessage) {\n      return NextResponse.json({ error: 'Please include a message.' }, { status: 400 });\n    }\n\n    const dbUrl = process.env.DATABASE_URL;\n    if (!dbUrl) {\n      return NextResponse.json(\n        { error: 'Database not configured. Set DATABASE_URL in your environment.' },\n        { status: 500 }\n      );\n    }\n\n    const sql = neon(dbUrl);\n    const rows = await sql`\n      INSERT INTO chat_inquiries (name, email, subject, messages)\n      VALUES (${name ?? null}, ${email ?? null}, ${subject ?? null}, ${JSON.stringify([\n        { role: 'user', content: trimmedMessage },\n      ])}::jsonb)\n      RETURNING id, createdAt;\n    `;\n\n    const inquiryId = rows?.[0]?.id ?? null;\n    return NextResponse.json({ inquiryId, message: 'Your note has been saved. Someone on the team will take it from here.' });\n  } catch (err) {\n    console.error('Inquiry save error:', err);\n    return NextResponse.json(\n      { error: err instanceof Error ? err.message : 'Unable to save your inquiry right now.' },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AASO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,GAAI,MAAM,IAAI,IAAI;QACzD,MAAM,iBAAiB,SAAS,UAAU;QAE1C,IAAI,CAAC,gBAAgB;YACnB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA4B,GAAG;gBAAE,QAAQ;YAAI;QACjF;QAEA,MAAM,QAAQ,QAAQ,GAAG,CAAC,YAAY;QACtC,IAAI,CAAC,OAAO;YACV,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAiE,GAC1E;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,MAAM,IAAA,gKAAI,EAAC;QACjB,MAAM,OAAO,MAAM,GAAG,CAAC;;cAEb,EAAE,QAAQ,KAAK,EAAE,EAAE,SAAS,KAAK,EAAE,EAAE,WAAW,KAAK,EAAE,EAAE,KAAK,SAAS,CAAC;YAC9E;gBAAE,MAAM;gBAAQ,SAAS;YAAe;SACzC,EAAE;;IAEL,CAAC;QAED,MAAM,YAAY,MAAM,CAAC,EAAE,EAAE,MAAM;QACnC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;YAAW,SAAS;QAAwE;IACzH,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,eAAe,QAAQ,IAAI,OAAO,GAAG;QAAyC,GACvF;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}