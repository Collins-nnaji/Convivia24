{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///Users/collinsnnaji/VSCodeDevelopments/convivia24/app/admin/clients/page.tsx"],"sourcesContent":["import { requireAdmin } from '@/lib/auth/session';\nimport sql from '@/lib/db';\nimport Link from 'next/link';\nimport { ArrowRight, Plus } from 'lucide-react';\n\nexport default async function ClientsPage() {\n  await requireAdmin();\n\n  const clients = await sql`\n    SELECT\n      c.*,\n      COUNT(DISTINCT d.id)  as deal_count,\n      COUNT(DISTINCT m.id)  FILTER (WHERE m.sender_role = 'client' AND m.read_at IS NULL) as unread_count,\n      u.name as admin_name\n    FROM clients c\n    LEFT JOIN pipeline_deals d ON d.client_id = c.id\n    LEFT JOIN messages m ON m.client_id = c.id\n    LEFT JOIN app_users u ON u.id = c.assigned_admin\n    GROUP BY c.id, u.name\n    ORDER BY c.created_at DESC\n  `;\n\n  return (\n    <div className=\"p-8 max-w-5xl\">\n      <div className=\"flex items-end justify-between mb-8\">\n        <div>\n          <span className=\"inline-block bg-red-700 text-white text-[9px] font-black uppercase tracking-[0.2em] px-2 py-1 mb-3\">\n            Clients\n          </span>\n          <h1 className=\"text-3xl font-black tracking-tighter text-white uppercase italic\">\n            All Clients\n          </h1>\n          <p className=\"text-zinc-500 text-sm mt-1\">{clients.length} account{clients.length !== 1 ? 's' : ''}</p>\n        </div>\n        <Link\n          href=\"/admin/clients/new\"\n          className=\"flex items-center gap-2 bg-red-700 hover:bg-red-800 text-white text-sm font-black uppercase tracking-[0.1em] px-4 py-2.5 transition-colors\"\n        >\n          <Plus size={14} />\n          New Client\n        </Link>\n      </div>\n\n      <div className=\"bg-zinc-900 border border-zinc-800\">\n        {clients.length === 0 && (\n          <p className=\"text-zinc-600 text-sm text-center py-12\">No clients yet. Add one to get started.</p>\n        )}\n        <div className=\"divide-y divide-zinc-800\">\n          {clients.map((c: any) => (\n            <Link\n              key={c.id}\n              href={`/admin/clients/${c.id}`}\n              className=\"group flex items-center justify-between px-6 py-4 hover:bg-zinc-800 transition-colors\"\n            >\n              <div className=\"flex items-center gap-4\">\n                <div className=\"w-9 h-9 bg-red-700 flex items-center justify-center text-white text-sm font-black shrink-0\">\n                  {c.name[0].toUpperCase()}\n                </div>\n                <div>\n                  <p className=\"text-sm font-semibold text-white\">{c.name}</p>\n                  <div className=\"flex items-center gap-3 mt-0.5\">\n                    {c.industry && <span className=\"text-[11px] text-zinc-500\">{c.industry}</span>}\n                    <span className={`text-[9px] font-black uppercase tracking-[0.1em] px-1.5 py-0.5 ${c.status === 'active' ? 'bg-green-900 text-green-400' : 'bg-zinc-800 text-zinc-500'}`}>\n                      {c.status}\n                    </span>\n                  </div>\n                </div>\n              </div>\n              <div className=\"flex items-center gap-6 text-right\">\n                <div>\n                  <p className=\"text-sm font-semibold text-white\">{c.deal_count}</p>\n                  <p className=\"text-[10px] text-zinc-600\">deals</p>\n                </div>\n                {parseInt(c.unread_count) > 0 && (\n                  <div className=\"bg-red-700 text-white text-[10px] font-black rounded-full w-5 h-5 flex items-center justify-center\">\n                    {c.unread_count}\n                  </div>\n                )}\n                <ArrowRight size={14} className=\"text-zinc-600 group-hover:text-red-500 transition-colors\" />\n              </div>\n            </Link>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AAAA;;;;;;AAEe,eAAe;IAC5B,MAAM,IAAA,sIAAY;IAElB,MAAM,UAAU,MAAM,6HAAG,CAAC;;;;;;;;;;;;EAY1B,CAAC;IAED,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;0CACC,8OAAC;gCAAK,WAAU;0CAAqG;;;;;;0CAGrH,8OAAC;gCAAG,WAAU;0CAAmE;;;;;;0CAGjF,8OAAC;gCAAE,WAAU;;oCAA8B,QAAQ,MAAM;oCAAC;oCAAS,QAAQ,MAAM,KAAK,IAAI,MAAM;;;;;;;;;;;;;kCAElG,8OAAC,0LAAI;wBACH,MAAK;wBACL,WAAU;;0CAEV,8OAAC,0MAAI;gCAAC,MAAM;;;;;;4BAAM;;;;;;;;;;;;;0BAKtB,8OAAC;gBAAI,WAAU;;oBACZ,QAAQ,MAAM,KAAK,mBAClB,8OAAC;wBAAE,WAAU;kCAA0C;;;;;;kCAEzD,8OAAC;wBAAI,WAAU;kCACZ,QAAQ,GAAG,CAAC,CAAC,kBACZ,8OAAC,0LAAI;gCAEH,MAAM,CAAC,eAAe,EAAE,EAAE,EAAE,EAAE;gCAC9B,WAAU;;kDAEV,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAI,WAAU;0DACZ,EAAE,IAAI,CAAC,EAAE,CAAC,WAAW;;;;;;0DAExB,8OAAC;;kEACC,8OAAC;wDAAE,WAAU;kEAAoC,EAAE,IAAI;;;;;;kEACvD,8OAAC;wDAAI,WAAU;;4DACZ,EAAE,QAAQ,kBAAI,8OAAC;gEAAK,WAAU;0EAA6B,EAAE,QAAQ;;;;;;0EACtE,8OAAC;gEAAK,WAAW,CAAC,+DAA+D,EAAE,EAAE,MAAM,KAAK,WAAW,gCAAgC,6BAA6B;0EACrK,EAAE,MAAM;;;;;;;;;;;;;;;;;;;;;;;;kDAKjB,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;;kEACC,8OAAC;wDAAE,WAAU;kEAAoC,EAAE,UAAU;;;;;;kEAC7D,8OAAC;wDAAE,WAAU;kEAA4B;;;;;;;;;;;;4CAE1C,SAAS,EAAE,YAAY,IAAI,mBAC1B,8OAAC;gDAAI,WAAU;0DACZ,EAAE,YAAY;;;;;;0DAGnB,8OAAC,gOAAU;gDAAC,MAAM;gDAAI,WAAU;;;;;;;;;;;;;+BA5B7B,EAAE,EAAE;;;;;;;;;;;;;;;;;;;;;;AAoCvB"}}]
}