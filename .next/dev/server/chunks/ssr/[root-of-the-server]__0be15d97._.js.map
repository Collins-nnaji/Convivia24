{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///Users/collinsnnaji/VSCodeDevelopments/convivia24/app/admin/page.tsx"],"sourcesContent":["import { requireAdmin } from '@/lib/auth/session';\nimport sql from '@/lib/db';\nimport Link from 'next/link';\nimport { Users, GitBranch, MessageSquare, ClipboardList, ArrowRight } from 'lucide-react';\n\nexport default async function AdminOverview() {\n  await requireAdmin();\n\n  const [\n    clientCount,\n    dealCount,\n    unreadCount,\n    leadCount,\n    recentDeals,\n    recentLeads,\n  ] = await Promise.all([\n    sql`SELECT COUNT(*) as count FROM clients WHERE status = 'active'`,\n    sql`SELECT COUNT(*) as count FROM pipeline_deals WHERE stage NOT IN ('closed_won','closed_lost')`,\n    sql`SELECT COUNT(*) as count FROM messages WHERE sender_role = 'client' AND read_at IS NULL`,\n    sql`SELECT COUNT(*) as count FROM audit_leads WHERE status = 'new'`,\n    sql`SELECT d.*, c.name as client_name FROM pipeline_deals d JOIN clients c ON c.id = d.client_id ORDER BY d.updated_at DESC LIMIT 6`,\n    sql`SELECT * FROM audit_leads WHERE status = 'new' ORDER BY created_at DESC LIMIT 5`,\n  ]);\n\n  const stats = [\n    { label: 'Active Clients',    value: clientCount[0].count,  icon: Users,         href: '/admin/clients' },\n    { label: 'Open Deals',        value: dealCount[0].count,    icon: GitBranch,     href: '/admin/pipeline' },\n    { label: 'Unread Messages',   value: unreadCount[0].count,  icon: MessageSquare, href: '/admin/messages' },\n    { label: 'New Audit Leads',   value: leadCount[0].count,    icon: ClipboardList, href: '/admin/leads' },\n  ];\n\n  const STAGE_COLORS: Record<string, string> = {\n    lead: 'bg-zinc-700', qualified: 'bg-blue-700', proposal: 'bg-yellow-600',\n    negotiation: 'bg-orange-600', closed_won: 'bg-green-700', closed_lost: 'bg-zinc-600',\n  };\n\n  return (\n    <div className=\"p-8 max-w-6xl\">\n      <div className=\"mb-8\">\n        <span className=\"inline-block bg-red-700 text-white text-[9px] font-black uppercase tracking-[0.2em] px-2 py-1 mb-3\">\n          Command Center\n        </span>\n        <h1 className=\"text-3xl font-black tracking-tighter text-white uppercase italic\">\n          Admin Overview\n        </h1>\n        <p className=\"text-zinc-500 text-sm mt-1\">Everything across all client accounts</p>\n      </div>\n\n      {/* Stats */}\n      <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\n        {stats.map(({ label, value, icon: Icon, href }) => (\n          <Link key={label} href={href}\n            className=\"group bg-zinc-900 border border-zinc-800 hover:border-red-700 p-5 transition-colors\"\n          >\n            <Icon size={16} className=\"text-red-700 mb-3\" />\n            <p className=\"text-2xl font-black text-white tracking-tighter\">{value}</p>\n            <p className=\"text-[11px] text-zinc-500 uppercase tracking-[0.15em] mt-1\">{label}</p>\n          </Link>\n        ))}\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Recent deals */}\n        <div className=\"bg-zinc-900 border border-zinc-800\">\n          <div className=\"flex items-center justify-between px-6 py-4 border-b border-zinc-800\">\n            <h2 className=\"text-sm font-black uppercase tracking-[0.15em] text-white\">Recent Deals</h2>\n            <Link href=\"/admin/pipeline\" className=\"text-[11px] text-red-500 hover:text-red-400 flex items-center gap-1\">\n              All <ArrowRight size={11} />\n            </Link>\n          </div>\n          <div className=\"divide-y divide-zinc-800\">\n            {recentDeals.map((d: any) => (\n              <div key={d.id} className=\"flex items-center justify-between px-6 py-3\">\n                <div className=\"flex items-center gap-2 min-w-0\">\n                  <span className={`shrink-0 text-[9px] font-black uppercase text-white px-1.5 py-0.5 ${STAGE_COLORS[d.stage] || 'bg-zinc-700'}`}>\n                    {d.stage.replace('_', ' ')}\n                  </span>\n                  <div className=\"min-w-0\">\n                    <p className=\"text-sm text-zinc-200 truncate\">{d.title}</p>\n                    <p className=\"text-[11px] text-zinc-500 truncate\">{d.client_name}</p>\n                  </div>\n                </div>\n                {d.value && (\n                  <span className=\"text-sm font-semibold text-white shrink-0 ml-2\">\n                    Â£{parseFloat(d.value).toLocaleString()}\n                  </span>\n                )}\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* New leads */}\n        <div className=\"bg-zinc-900 border border-zinc-800\">\n          <div className=\"flex items-center justify-between px-6 py-4 border-b border-zinc-800\">\n            <h2 className=\"text-sm font-black uppercase tracking-[0.15em] text-white\">New Audit Leads</h2>\n            <Link href=\"/admin/leads\" className=\"text-[11px] text-red-500 hover:text-red-400 flex items-center gap-1\">\n              All <ArrowRight size={11} />\n            </Link>\n          </div>\n          <div className=\"divide-y divide-zinc-800\">\n            {recentLeads.length === 0 && (\n              <p className=\"text-zinc-600 text-sm text-center py-6\">No new leads</p>\n            )}\n            {recentLeads.map((lead: any) => (\n              <div key={lead.id} className=\"px-6 py-3\">\n                <p className=\"text-sm font-semibold text-white\">{lead.company || 'Unknown Company'}</p>\n                <p className=\"text-[11px] text-zinc-500\">{lead.email}</p>\n                <p className=\"text-[10px] text-zinc-600 mt-0.5\">\n                  {new Date(lead.created_at).toLocaleDateString('en-GB')}\n                </p>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}