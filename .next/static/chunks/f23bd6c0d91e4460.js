(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,43447,99749,92808,e=>{"use strict";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(n){t(e,n,r[n])})}return e}function r(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}e.s(["_",()=>t],99749),e.s(["_",()=>n],43447),e.s(["_",()=>r],92808)},75254,33027,e=>{"use strict";var t=e.i(43447);function n(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}e.s(["_",()=>n],33027);var r=e.i(71645);let a=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var i=e.i(92808),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,r.forwardRef)((e,l)=>{var{color:c="currentColor",size:o=24,strokeWidth:d=2,absoluteStrokeWidth:u,className:p="",children:h,iconNode:m}=e,x=n(e,["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"]);return(0,r.createElement)("svg",(0,t._)((0,i._)((0,t._)({ref:l},s),{width:o,height:o,stroke:c,strokeWidth:u?24*Number(d)/Number(o):d,className:a("lucide",p)}),x),[...m.map(e=>{let[t,n]=e;return(0,r.createElement)(t,n)}),...Array.isArray(h)?h:[h]])}),c=(e,i)=>{let s=(0,r.forwardRef)((s,c)=>{var{className:o}=s,d=n(s,["className"]);return(0,r.createElement)(l,(0,t._)({ref:c,iconNode:i,className:a("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),o)},d))});return s.displayName="".concat(e),s};e.s(["default",()=>c],75254)},87179,e=>{"use strict";var t=e.i(43476),n=e.i(71645),r=e.i(75254);let a=(0,r.default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),i=(0,r.default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),s=(0,r.default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),l=(0,r.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function c(){let[e,r]=(0,n.useState)([]),[c,o]=(0,n.useState)(!0),[d,u]=(0,n.useState)(!1),[p,h]=(0,n.useState)(""),[m,x]=(0,n.useState)(null),[f,y]=(0,n.useState)(""),b=(0,n.useRef)(null);async function g(){let e=await fetch("/api/documents");e.ok&&r(await e.json()),o(!1)}async function j(e){var t,n,r;let a=null==(t=e.target.files)?void 0:t[0];if(a){u(!0),h("Requesting upload URL…");try{let e=await fetch("/api/documents/presign",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a.name,type:a.type,size:a.size})}),t=await e.json().catch(()=>({}));if(!e.ok)throw Error(null!=(n=null==t?void 0:t.error)?n:"Failed to get upload URL (".concat(e.status,")"));let{uploadUrl:i,key:s}=t;h("Uploading…");let l=await fetch(i,{method:"PUT",headers:{"Content-Type":a.type},body:a});if(!l.ok){let e=await l.text();throw Error("Storage upload failed (".concat(l.status,"). ").concat(e.slice(0,100)))}h("Saving…");let c={name:a.name,key:s,size:a.size,type:a.type};(null==m?void 0:m.role)==="admin"&&f&&(c.clientId=f);let o=await fetch("/api/documents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),d=await o.json().catch(()=>({}));if(!o.ok)throw Error(null!=(r=null==d?void 0:d.error)?r:"Failed to save document (".concat(o.status,")"));h(""),await g()}catch(t){let e=t instanceof Error?t.message:"Upload failed";h("Error: ".concat(e))}finally{u(!1),b.current&&(b.current.value="")}}}async function v(e){confirm("Delete this document?")&&(await fetch("/api/documents/".concat(e),{method:"DELETE"}),await g())}return(0,n.useEffect)(()=>{g(),fetch("/api/me").then(e=>e.ok?e.json():null).then(e=>{var t;(null==e?void 0:e.role)==="admin"&&(null==e||null==(t=e.clients)?void 0:t.length)&&(x(e),y(e.clients[0].id))}).catch(()=>{})},[]),(0,t.jsxs)("div",{className:"p-8 max-w-4xl",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("span",{className:"inline-block bg-red-600 text-white text-[9px] font-black uppercase tracking-[0.2em] px-2 py-1 mb-3",children:"Documents"}),(0,t.jsx)("h1",{className:"text-3xl font-black tracking-tighter text-zinc-900 uppercase italic",children:"Files & Reports"}),(0,t.jsx)("p",{className:"text-zinc-600 text-sm mt-1",children:"All documents shared with your account"})]}),(0,t.jsxs)("div",{className:"bg-white border border-zinc-200 border-dashed rounded-lg p-8 mb-6 text-center shadow-sm",children:[(0,t.jsx)(a,{size:24,className:"mx-auto text-zinc-400 mb-3"}),(0,t.jsx)("p",{className:"text-sm text-zinc-600 mb-3",children:"Upload a document"}),(null==m?void 0:m.role)==="admin"&&(m.clients&&m.clients.length>0?(0,t.jsxs)("div",{className:"mb-3 flex justify-center",children:[(0,t.jsx)("label",{className:"text-xs text-zinc-500 mr-2",children:"Client:"}),(0,t.jsx)("select",{value:f,onChange:e=>y(e.target.value),className:"bg-white border border-zinc-300 text-zinc-900 text-sm px-3 py-1.5 rounded focus:outline-none focus:border-red-500",children:m.clients.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))})]}):(0,t.jsx)("p",{className:"text-xs text-zinc-500 mb-3",children:"Create a client in Admin first, then upload."})),(0,t.jsx)("input",{ref:b,type:"file",onChange:j,className:"hidden",id:"file-upload"}),(0,t.jsx)("label",{htmlFor:"file-upload",className:"inline-flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white text-sm font-black uppercase tracking-[0.1em] px-5 py-2.5 cursor-pointer transition-colors rounded ".concat(d?"opacity-50 pointer-events-none":""),children:d?p||"Uploading…":"Choose File"})]}),(0,t.jsxs)("div",{className:"bg-white border border-zinc-200 rounded-lg shadow-sm",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-zinc-200",children:(0,t.jsxs)("h2",{className:"text-sm font-black uppercase tracking-[0.15em] text-zinc-900",children:[e.length," Document",1!==e.length?"s":""]})}),c&&(0,t.jsx)("p",{className:"text-zinc-500 text-sm text-center py-8",children:"Loading…"}),!c&&0===e.length&&(0,t.jsx)("p",{className:"text-zinc-500 text-sm text-center py-8",children:"No documents yet."}),(0,t.jsx)("div",{className:"divide-y divide-zinc-100",children:e.map(e=>{var n;return(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,t.jsx)(i,{size:18,className:"text-red-600 shrink-0"}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-zinc-900 truncate",children:e.name}),(0,t.jsxs)("p",{className:"text-[11px] text-zinc-500",children:[(n=e.size_bytes)<1024?"".concat(n," B"):n<1048576?"".concat((n/1024).toFixed(1)," KB"):"".concat((n/1048576).toFixed(1)," MB")," · ",new Date(e.created_at).toLocaleDateString("en-GB")]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 shrink-0 ml-4",children:[(0,t.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-zinc-400 hover:text-zinc-900 transition-colors",title:"Download",children:(0,t.jsx)(s,{size:15})}),(0,t.jsx)("button",{onClick:()=>v(e.id),className:"p-2 text-zinc-400 hover:text-red-600 transition-colors",title:"Delete",children:(0,t.jsx)(l,{size:15})})]})]},e.id)})})]})]})}e.s(["default",()=>c],87179)}]);