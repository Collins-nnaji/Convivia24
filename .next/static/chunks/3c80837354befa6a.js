(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,43447,99749,92808,e=>{"use strict";function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function s(e){for(var s=1;s<arguments.length;s++){var i=null!=arguments[s]?arguments[s]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(s){t(e,s,i[s])})}return e}function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);s.push.apply(s,i)}return s})(Object(t)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}),e}e.s(["_",()=>t],99749),e.s(["_",()=>s],43447),e.s(["_",()=>i],92808)},75254,33027,e=>{"use strict";var t=e.i(43447);function s(e,t){if(null==e)return{};var s,i,n=function(e,t){if(null==e)return{};var s,i,n={},r=Object.keys(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||(n[s]=e[s]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)s=r[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}e.s(["_",()=>s],33027);var i=e.i(71645);let n=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()};var r=e.i(92808),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,i.forwardRef)((e,l)=>{var{color:c="currentColor",size:o=24,strokeWidth:d=2,absoluteStrokeWidth:u,className:p="",children:x,iconNode:m}=e,h=s(e,["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"]);return(0,i.createElement)("svg",(0,t._)((0,r._)((0,t._)({ref:l},a),{width:o,height:o,stroke:c,strokeWidth:u?24*Number(d)/Number(o):d,className:n("lucide",p)}),h),[...m.map(e=>{let[t,s]=e;return(0,i.createElement)(t,s)}),...Array.isArray(x)?x:[x]])}),c=(e,r)=>{let a=(0,i.forwardRef)((a,c)=>{var{className:o}=a,d=s(a,["className"]);return(0,i.createElement)(l,(0,t._)({ref:c,iconNode:r,className:n("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),o)},d))});return a.displayName="".concat(e),a};e.s(["default",()=>c],75254)},14764,e=>{"use strict";let t=(0,e.i(75254).default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],14764)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},71689,e=>{"use strict";let t=(0,e.i(75254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},37727,e=>{"use strict";let t=(0,e.i(75254).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],37727)},58363,e=>{"use strict";var t=e.i(43476),s=e.i(71645),i=e.i(18566),n=e.i(22016),r=e.i(71689),a=e.i(14764),l=e.i(75254);let c=(0,l.default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),o=(0,l.default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var d=e.i(43531),u=e.i(37727);let p={draft:"Draft",submitted:"Submitted",price_agreed:"Price agreed",listed:"Listed",sold:"Sold",withdrawn:"Withdrawn"},x={draft:"Edit and submit when ready. We’ll then agree price and commission in Messages.",submitted:"We’re reviewing. We’ll message you to agree price and commission.",price_agreed:"Terms are agreed. We’re listing and working on the sale.",listed:"Listed for sale. We’ll update you when it sells.",sold:"Sold. Sale value and commission are recorded.",withdrawn:"This listing was withdrawn."};function m(e,t){if(null==e||""===e)return"—";let s="string"==typeof e?parseFloat(e):e;return isNaN(s)?"—":"".concat("GBP"===t?"£":t+" ").concat(s.toLocaleString())}function h(){var e,l;let h,b;(0,i.useRouter)();let f=(0,i.useParams)(),g=null==f?void 0:f.id,[j,y]=(0,s.useState)(null),[v,w]=(0,s.useState)(!0),[N,k]=(0,s.useState)(!1),[z,S]=(0,s.useState)(!1),[O,_]=(0,s.useState)(""),[C,P]=(0,s.useState)(""),[A,T]=(0,s.useState)(""),[L,D]=(0,s.useState)("GBP"),[E,M]=(0,s.useState)("");async function B(){if(j){k(!0);try{let e=await fetch("/api/listings/".concat(j.id),{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({action:"submit"})});if(e.ok){let t=await e.json();y(t)}}finally{k(!1)}}}async function W(){if(!j)return;let e=await fetch("/api/listings/".concat(j.id),{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:O.trim(),description:C.trim()||void 0,asking_price:A?Number(A):void 0,currency:L,commission_pct:E?Number(E):void 0})});e.ok&&(y(await e.json()),S(!1))}if((0,s.useEffect)(()=>{g&&fetch("/api/listings/".concat(g),{credentials:"include"}).then(e=>e.ok?e.json():null).then(e=>{if(e){var t,s,i;y(e),_(null!=(t=e.title)?t:""),P(null!=(s=e.description)?s:""),T(null!=e.asking_price&&""!==e.asking_price?String(e.asking_price):""),D(null!=(i=e.currency)?i:"GBP"),M(null!=e.commission_pct&&""!==e.commission_pct?String(e.commission_pct):"")}}).finally(()=>w(!1))},[g]),v||!j)return(0,t.jsxs)("div",{className:"p-8",children:[(0,t.jsx)("p",{className:"text-zinc-500 text-sm",children:v?"Loading…":"Listing not found."}),!v&&(0,t.jsx)(n.default,{href:"/dashboard/listings",className:"text-red-600 text-sm font-semibold mt-2 inline-block",children:"← Back to listings"})]});let R="draft"===j.status;return(0,t.jsxs)("div",{className:"p-8 max-w-2xl",children:[(0,t.jsxs)(n.default,{href:"/dashboard/listings",className:"inline-flex items-center gap-1.5 text-zinc-600 hover:text-zinc-900 text-sm font-semibold mb-6",children:[(0,t.jsx)(r.ArrowLeft,{size:14}),"Back to listings"]}),(0,t.jsxs)("div",{className:"bg-white border border-zinc-200 rounded-lg shadow-sm overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-zinc-200 flex items-center justify-between flex-wrap gap-2",children:[(0,t.jsx)("span",{className:"text-[10px] font-black uppercase px-2 py-0.5 rounded bg-zinc-200 text-zinc-700",children:null!=(e=p[j.status])?e:j.status}),R&&!z&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>S(!0),className:"inline-flex items-center gap-1.5 text-zinc-600 hover:text-zinc-900 text-xs font-semibold",children:[(0,t.jsx)(o,{size:12}),"Edit"]}),(0,t.jsxs)("button",{type:"button",onClick:B,disabled:N,className:"inline-flex items-center gap-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold uppercase px-3 py-2 rounded transition-colors disabled:opacity-60",children:[(0,t.jsx)(a.Send,{size:12}),N?"Submitting…":"Submit to Convivia24"]})]})]}),(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[x[j.status]&&(0,t.jsx)("p",{className:"text-sm text-zinc-600 bg-zinc-50 border border-zinc-200 rounded-lg px-4 py-3",children:x[j.status]}),z?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold uppercase text-zinc-500 mb-1",children:"Title *"}),(0,t.jsx)("input",{value:O,onChange:e=>_(e.target.value),className:"w-full border border-zinc-200 rounded px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold uppercase text-zinc-500 mb-1",children:"Description"}),(0,t.jsx)("textarea",{value:C,onChange:e=>P(e.target.value),rows:3,className:"w-full border border-zinc-200 rounded px-3 py-2 text-sm resize-y"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold uppercase text-zinc-500 mb-1",children:"Asking price"}),(0,t.jsx)("input",{type:"number",min:"0",step:"0.01",value:A,onChange:e=>T(e.target.value),className:"w-full border border-zinc-200 rounded px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold uppercase text-zinc-500 mb-1",children:"Currency"}),(0,t.jsxs)("select",{value:L,onChange:e=>D(e.target.value),className:"w-full border border-zinc-200 rounded px-3 py-2 text-sm",children:[(0,t.jsx)("option",{value:"GBP",children:"GBP"}),(0,t.jsx)("option",{value:"USD",children:"USD"}),(0,t.jsx)("option",{value:"EUR",children:"EUR"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold uppercase text-zinc-500 mb-1",children:"Commission %"}),(0,t.jsx)("input",{type:"number",min:"0",max:"100",step:"0.5",value:E,onChange:e=>M(e.target.value),className:"w-full border border-zinc-200 rounded px-3 py-2 text-sm max-w-[120px]"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{type:"button",onClick:W,className:"inline-flex items-center gap-1.5 bg-red-600 hover:bg-red-700 text-white text-sm font-bold px-4 py-2 rounded",children:[(0,t.jsx)(d.Check,{size:14}),"Save"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>S(!1),className:"inline-flex items-center gap-1.5 border border-zinc-300 text-zinc-700 text-sm font-semibold px-4 py-2 rounded hover:bg-zinc-50",children:[(0,t.jsx)(u.X,{size:14}),"Cancel"]})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-black text-zinc-900 tracking-tight",children:j.title}),(0,t.jsxs)("p",{className:"text-[11px] text-zinc-500 mt-1",children:["Updated ",(h=new Date(j.updated_at),0===(b=Math.floor((new Date().getTime()-h.getTime())/864e5))?"Today":1===b?"Yesterday":b<7?"".concat(b," days ago"):b<30?"".concat(Math.floor(b/7)," weeks ago"):h.toLocaleDateString())]})]}),j.description&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xs font-bold uppercase text-zinc-500 mb-1",children:"Description"}),(0,t.jsx)("p",{className:"text-sm text-zinc-700 whitespace-pre-wrap",children:j.description})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] text-zinc-500 uppercase font-bold",children:"Asking price"}),(0,t.jsx)("p",{className:"text-zinc-900",children:m(j.asking_price,j.currency)})]}),null!=j.agreed_price&&""!==j.agreed_price&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] text-zinc-500 uppercase font-bold",children:"Agreed price"}),(0,t.jsx)("p",{className:"text-zinc-900",children:m(j.agreed_price,j.currency)})]}),null!=j.commission_pct&&""!==j.commission_pct||null!=j.agreed_commission_pct&&""!==j.agreed_commission_pct?(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] text-zinc-500 uppercase font-bold",children:"Commission"}),(0,t.jsxs)("p",{className:"text-zinc-900",children:[Number(null!=(l=j.agreed_commission_pct)?l:j.commission_pct),"%"]})]}):null,"sold"===j.status&&null!=j.sale_value&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] text-zinc-500 uppercase font-bold",children:"Sale value"}),(0,t.jsx)("p",{className:"text-green-700 font-semibold",children:m(j.sale_value,j.currency)})]})]})]}),(0,t.jsxs)(n.default,{href:"/dashboard/messages",className:"inline-flex items-center gap-2 text-red-600 hover:text-red-700 text-sm font-semibold",children:[(0,t.jsx)(c,{size:14}),"Open Messages to discuss this listing"]})]})]})]})}e.s(["default",()=>h],58363)}]);